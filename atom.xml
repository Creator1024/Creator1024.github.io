<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>oneWay</title>
  
  
  <link href="/blog/atom.xml" rel="self"/>
  
  <link href="http://534160110.gitee.io/blog/"/>
  <updated>2018-05-25T14:26:58.569Z</updated>
  <id>http://534160110.gitee.io/blog/</id>
  
  <author>
    <name>oneWay</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Ipsec</title>
    <link href="http://534160110.gitee.io/blog/2018/05/25/Ipsec/"/>
    <id>http://534160110.gitee.io/blog/2018/05/25/Ipsec/</id>
    <published>2018-05-25T14:25:18.000Z</published>
    <updated>2018-05-25T14:26:58.569Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://upload-images.jianshu.io/upload_images/12329802-035c3a2c41fb8a46.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图片.png"></p><h5 id="1-配置基本信息"><a href="#1-配置基本信息" class="headerlink" title="1.配置基本信息"></a>1.配置基本信息</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">AR1和AR3都写入一条默认路由模拟到达外网</span><br><span class="line">[AR1]ip route-static 0.0.0.0 0.0.0.0 12.1.1.2</span><br><span class="line">[AR3]ip route-static 0.0.0.0 0.0.0.0 23.1.1.2</span><br></pre></td></tr></table></figure><h5 id="2-配置IPSec"><a href="#2-配置IPSec" class="headerlink" title="2.配置IPSec"></a>2.配置IPSec</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">总部路由器（AR1）配置</span><br><span class="line">1.抓取内网流量</span><br><span class="line">[AR1]acl 3000</span><br><span class="line">[AR1-acl-adv-3000]rule 5 permit ip source 192.168.1.0 0.0.0.255 destination 192.</span><br><span class="line">168.2.0 0.0.0.255</span><br><span class="line"></span><br><span class="line">2.配置ike</span><br><span class="line">[AR1]ike proposal 1</span><br><span class="line">[AR1-ike-proposal-1]encryption-algorithm 3des-cbc</span><br><span class="line">[AR1-ike-proposal-1]authentication-algorithm md5</span><br><span class="line">[AR1-ike-proposal-1]quit</span><br><span class="line"></span><br><span class="line">[AR1]ike peer AR3 v1</span><br><span class="line">[AR1-ike-peer-AR3]pre-shared-key simple oneWay //设置协商密钥，隧道两端要一致</span><br><span class="line">[AR1-ike-peer-AR3]ike-proposal 1 //调用刚刚创建的ike</span><br><span class="line">[AR1-ike-peer-AR3]remote-address 23.1.1.3 </span><br><span class="line"></span><br><span class="line">3.配置IPSec</span><br><span class="line">[AR1]ipsec proposal 1</span><br><span class="line">[AR1-ipsec-proposal-1]transform ah</span><br><span class="line"></span><br><span class="line">[AR1]ipsec policy Test 10 isakmp</span><br><span class="line">[AR1-ipsec-policy-isakmp-Test-10]security acl 3000 //isakmp使用ike建立ipsec SA</span><br><span class="line">[AR1-ipsec-policy-isakmp-Test-10]ike-peer AR3</span><br><span class="line">[AR1-ipsec-policy-isakmp-Test-10]proposal 1</span><br><span class="line"></span><br><span class="line">4.接口下调用ipsec policy</span><br><span class="line">[AR1-GigabitEthernet0/0/1]ipsec policy Test</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">分部路由器（AR3）配置</span><br><span class="line">[AR3]acl 3000</span><br><span class="line">[AR3-acl-adv-3000]rule 5 permit ip source 192.168.2.0 0.0.0.255 destination 192.</span><br><span class="line">168.1.0 0.0.0.255</span><br><span class="line">[AR3]ike proposal 1</span><br><span class="line">[AR3-ike-proposal-1]encryption-algorithm 3des-cbc </span><br><span class="line">[AR3-ike-proposal-1]authentication-algorithm md5</span><br><span class="line"></span><br><span class="line">[AR3]ike peer AR1 v1</span><br><span class="line">[AR3-ike-peer-AR1]pre-shared-key simple oneWay</span><br><span class="line">[AR3-ike-peer-AR1]ike-proposal 1</span><br><span class="line">[AR3-ike-peer-AR1]remote-address 12.1.1.1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[AR3]ipsec proposal 1</span><br><span class="line">[AR3-ipsec-proposal-1]transform ah</span><br><span class="line"></span><br><span class="line">[AR3]ipsec policy Test 10 isakmp </span><br><span class="line">[AR3-ipsec-policy-isakmp-Test-10]security acl 3000</span><br><span class="line">[AR3-ipsec-policy-isakmp-Test-10]ike-peer AR1</span><br><span class="line">[AR3-ipsec-policy-isakmp-Test-10]proposal 1</span><br><span class="line">[AR3-ipsec-policy-isakmp-Test-10]quit</span><br><span class="line"></span><br><span class="line">[AR3-GigabitEthernet0/0/0]ipsec policy Test</span><br></pre></td></tr></table></figure><h5 id="3-验证结果"><a href="#3-验证结果" class="headerlink" title="3.验证结果"></a>3.验证结果</h5><p>若配置错误，display不会出现以下信息：<br><img src="https://upload-images.jianshu.io/upload_images/12329802-840fdfacd0e501b3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图片.png">  </p><p>PC1成功ping通PC3：<br><img src="https://upload-images.jianshu.io/upload_images/12329802-df2374166c337940.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图片.png"> </p><p><img src="https://upload-images.jianshu.io/upload_images/12329802-856ee8d5980d6e3a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图片.png"></p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><blockquote><ul><li><a href=""></a></li><li><a href=""></a></li></ul></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/12329802-035c3a2c41fb8a46.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240
      
    
    </summary>
    
      <category term="数据通信" scheme="http://534160110.gitee.io/blog/categories/%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1/"/>
    
      <category term="R&amp;S配置" scheme="http://534160110.gitee.io/blog/categories/%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1/R-S%E9%85%8D%E7%BD%AE/"/>
    
      <category term="华为" scheme="http://534160110.gitee.io/blog/categories/%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1/R-S%E9%85%8D%E7%BD%AE/%E5%8D%8E%E4%B8%BA/"/>
    
    
      <category term="huawei" scheme="http://534160110.gitee.io/blog/tags/huawei/"/>
    
      <category term="IPSec" scheme="http://534160110.gitee.io/blog/tags/IPSec/"/>
    
      <category term="ospf" scheme="http://534160110.gitee.io/blog/tags/ospf/"/>
    
  </entry>
  
  <entry>
    <title>dhcp+ospf</title>
    <link href="http://534160110.gitee.io/blog/2018/05/24/dhcp+ospf/"/>
    <id>http://534160110.gitee.io/blog/2018/05/24/dhcp+ospf/</id>
    <published>2018-05-24T13:31:59.000Z</published>
    <updated>2018-05-25T14:27:03.889Z</updated>
    
    <content type="html"><![CDATA[<h4 id="HUAWEI-DHCP-OSPF-Test"><a href="#HUAWEI-DHCP-OSPF-Test" class="headerlink" title="HUAWEI DHCP+OSPF Test"></a>HUAWEI DHCP+OSPF Test</h4><pre><code>R1:dhcp enable //全局下先开启DHCP功能ip pool network1 gateway-list 192.168.1.1 network 192.168.1.0 mask 255.255.255.0 excluded-ip-address 192.168.1.2 //排除地址  dns-list 192.168.1.1interface Ethernet0/0/0 ip address 192.168.1.1 255.255.255.0 dhcp select global//该接口收到DHCP报文后直接去DHCP服务器在全局配置的IP地址池中寻找一个可用的地址interface Ethernet0/0/1 ip address 12.1.1.1 255.255.255.0  R2:dhcp enabledhcp server ping packet 10 timeout 100   //配置dhcp服务器分配某个ip之前先探测该ip是否已被网络中pc使用的功能，dhcp服务器会向该ip地址发10个包且每次100ms，无应答才会分配该ip地址给客户端dhcp check dhcp-rate enable           //开启dhcp的速率检测功能开关dhcp check dhcp-rate 90                //检测收到dhcp请求包的速率最大为90个/s，默认100个/s，防止dhcp泛红攻击ip pool network2 gateway-list 192.168.2.1 network 192.168.2.0 mask 255.255.255.0 dns-list 192.168.2.1 static-bind ip-address 192.168.2.10 mac-address 0001-1111-2222 //为固定mac分配固定ipinterface Ethernet0/0/0 ip address 12.1.1.2 255.255.255.0interface Ethernet0/0/1 ip address 23.1.1.2 255.255.255.0 dhcp select globalR3：ehcp enableinterface Ethernet0/0/0 ip address 23.1.1.3 255.255.255.0interface Ethernet0/0/1 ip address 192.168.2.1 255.255.255.0 dhcp select relay //dhcp中继 dhcp relay server-ip 23.1.1.2</code></pre><h5 id="此时PC1可以动态获取到ip地址，而PC2不可以。因为R2没有到达192-168-2-1的路由，无法回应Offer报文"><a href="#此时PC1可以动态获取到ip地址，而PC2不可以。因为R2没有到达192-168-2-1的路由，无法回应Offer报文" class="headerlink" title="此时PC1可以动态获取到ip地址，而PC2不可以。因为R2没有到达192.168.2.1的路由，无法回应Offer报文"></a>此时PC1可以动态获取到ip地址，而PC2不可以。因为R2没有到达192.168.2.1的路由，无法回应Offer报文</h5><pre><code>配置OPSF：  [R1]ospf 1 area 0.0.0.0  network 192.168.1.1 0.0.0.0  network 12.1.1.1 0.0.0.0[R2]ospf 1 area 0.0.0.0  network 12.1.1.2 0.0.0.0  network 23.1.1.2 0.0.0.0  [R3]ospf 1 area 0.0.0.0  network 192.168.2.1 0.0.0.0  network 23.1.1.3 0.0.0.0</code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h4 id=&quot;HUAWEI-DHCP-OSPF-Test&quot;&gt;&lt;a href=&quot;#HUAWEI-DHCP-OSPF-Test&quot; class=&quot;headerlink&quot; title=&quot;HUAWEI DHCP+OSPF Test&quot;&gt;&lt;/a&gt;HUAWEI DHCP+OSPF Test&lt;/
      
    
    </summary>
    
      <category term="数据通信" scheme="http://534160110.gitee.io/blog/categories/%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1/"/>
    
      <category term="R&amp;S配置" scheme="http://534160110.gitee.io/blog/categories/%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1/R-S%E9%85%8D%E7%BD%AE/"/>
    
      <category term="华为" scheme="http://534160110.gitee.io/blog/categories/%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1/R-S%E9%85%8D%E7%BD%AE/%E5%8D%8E%E4%B8%BA/"/>
    
    
      <category term="huawei" scheme="http://534160110.gitee.io/blog/tags/huawei/"/>
    
      <category term="ospf" scheme="http://534160110.gitee.io/blog/tags/ospf/"/>
    
      <category term="dhcp" scheme="http://534160110.gitee.io/blog/tags/dhcp/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="http://534160110.gitee.io/blog/2018/05/15/hello-world/"/>
    <id>http://534160110.gitee.io/blog/2018/05/15/hello-world/</id>
    <published>2018-05-15T03:29:09.533Z</published>
    <updated>2018-05-15T03:29:09.533Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.
      
    
    </summary>
    
    
  </entry>
  
</feed>
